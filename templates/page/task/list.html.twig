{% extends 'layout/left-side-column.html.twig' %}

{% block page %}
	{% embed "_page.html.twig" %}
		{% block page_title %}
			{{ 'Tasks list'|trans }}
		{% endblock %}

		{% block page_content %}
			<div class="row">
				<div class="col-md-12">
					<div class="tile">
						{% if taskToDelete is not null %}
							<p class="alert alert-danger">
								{% trans %}
									Are you sure to delete this task ? Times recorded to this task will also be lost.
									You cannot reverse this action.
								{% endtrans %}
							</p>
							<div class="modal-footer">
								<form method="POST" action="{{ path('delete_task') }}">
									<input type="hidden" value="{{ taskToDelete }}" name="id">
									<button type="submit" class="btn btn-secondary">Yes I am sure !</button>
								</form>
								<a href="{{ path('list_tasks') }}" class="btn btn-primary">No, please cancel.</a>
							</div>
						{% endif %}

						<a class="btn btn-outline-success" href="{{ path('add_task') }}">New Task</a>

						<table class="table table-hover table-striped table-bordered">
							<thead>
							<tr>
								<th>{{ 'Code'|trans }}</th>
								<th>{{ 'Name'|trans }}</th>
								<th>{{ 'Mother task'|trans }}</th>
								<th>{{ 'Edit'|trans }}</th>
								<th>{{ 'Delete'|trans }}</th>
							</tr>
							</thead>
							<tbody>
							{% for task in tasks %}
								<tr>
									<td>{{ task.code }}</td>
									<td>{{ task.name }}</td>
									<td>
										{% if task.motherTask is not null %}
											{% if task.motherTask.code is not null %}
												{{ task.motherTask.code }}
											{% endif %}
											-
											{{ task.motherTask.name }}
										{% endif %}
									</td>
									<td>
										<a class="btn btn-outline-primary" href="{{ path('edit_task', {'id':task.id}) }}">Edit</a>
									</td>
									<td>
										<form action="{{ path('list_tasks') }}" method="post">
											<input type="hidden" value="{{ task.id }}" name="taskToDelete">
											<button class="btn btn-outline-danger" type="submit">Delete</button>
										</form>
									</td>
								</tr>
							{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		{% endblock %}
	{% endembed %}
{% endblock %}

{% block javascripts %}
	{{ parent() }}
{% endblock %}
